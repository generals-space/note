#Verilog日志输出函数#

[参考文章](http://blog.163.com/vinsonsu@126/blog/static/7271071820108259239376/)

##1. 打印/写系统函数##

Verilog本质上也是一门高级语言, 因而也提供了丰富打印信息, 输出信息的系统函数.

这类函数包括

- `$display`, `$displayb`, `$displayo`, `$displayh`

- `$write`, `$writeb`, `$writeo`, `$writeh`等.  

其使用语法为: `系统函数名(变量列表)`;

变量列表就是需要输出的信息, 该变量列表可以是**变量名**, **表达式**, **双引号括起来的字符串**, 以及这三种形式的组合. 变量列表也可以为空. 这时, `$display`会输出一个回车符(就是开始新的一行), 而`$write`则相当于不进行任何操作. 

`$display`系列和`$write`系列除了一点差别外完全一致, 其差异在于`$display`会在变量列表后面自动增加一个回车符, 而$write则没有该功能, 完全按照变量列表指示的内容输出. (当变量列表为空时, $display输出一个回车符, 而$write则相当于不进行任何操作). 

下表给出各个函数默认的输出格式: 

|   |   |   |
|:-:|:-:|:-:|
|系统函数            |默认制式      |例子(a[7:0]=31)|
|$display, $write    |十进制        |$write(12," and ", a[7:0])|
|$displayb, $writeb  |二进制        |$writeb(12, " and ", a[7:0])|
|$displayo, $writeo  |八进制        |$writeo(12, " and ", a[7:0])|
|$displayh, $writeh  |十六进制      |$writeh(12, " and ", a[7:0])|

##2. 格式化输出##

Verilog的这些打印系统函数的使用同其他高级语言比如C中的打印函数很类似. 这些函数支持"**格式化输出**", 也是在双引号括起来的变量中加入转义符号实现的. 对于变量列表中的变量或者常量, 当指定了输出格式时, 这八个函数没有差别, 都将以指定格式输出其值; 当没有指定输出格式时, 各函数以默认的形式输出该变量或者常量的值. 

"格式化输出"功能需要使用转义符, 同其他高级语言中的定义和使用基本相同. Verilog的转义符分为两大类: 以"\\"引导的和以"%"引导的. 

- 以"%"引导的转义符用于指定**变量列表**中的变量, 常量, 表达式的格式化输出

- 以"\\"引导的表示其他的一些格式化输出功能, 通常是比较"特殊"的功能, 比如输出一个"TAB", 或者输出"\\"本身, 以及输出"%"本身等. 

下表给出了Verilog中基本的转义符定义和意义说明: 

|||
|:-:|:-:|
|转义符       |意义说明|
|%d 及 %D     |以十进制格式输出|
|%b 及 %B     |以二进制格式输出|
|%o 及 %O     |以八进制格式输出|
|%h 及 %H     |以十六进制格式输出|
|%s 及 %S     |以字符串格式输出|
|%c 及 %C     |以ASCII码格式输出|
|%v 及 %V     |输出线网类型变量的强度|
|%m 及 %M     |输出层次名|
|%t 及 %T     |以当前时间格式输出|
|%e 及 %E     |以指数表示方式输出实数(real型)|
|%f 及 %F     |以十进制数表示方式输出实数(real型)|
|%g 及 %G     |以十进制数或者以指数表示方式输出实数. 两种输出格式中, 哪种占用更少的宽度, 就使用哪一种. |
|||
|\\n          |开始新行("回车"功能)|
|\\t          |输出一个 TAB|
|\\"          |输出 " 本身|
|\\\\         |输出 \\ 本身|
|%%           |输出 % 本身|
|\\xyz        |xyz表示一个八进制数. \\xyz表示输出八进制数xyz的值对应的ASCII码符号. 比如, "\\123", 应该输出的为符号"S".|

例子2-1给出了这些转义符的基本使用: 

```php
// Filename: exe_2_1.v
// This module is writen by YiTurn Zhao
// Module Purpose : $display 和 $write的基本用法
module exe_2_1();
//
reg [7:0] a; 
initial begin 
a = 31; 
abcd = 50;
$display(" Using $display, a = ",a, " And 12 = ",12);
$displayb(" Using $displayb, a = ",a, " And 12 = ",12);
$displayo(" Using $displayo, a = ",a, " And 12 = ",12);
$displayh(" Using $displayh, a = ",a, " And 12 = ",12);
$writeo(" \\nUsing Formatted $writeh, a = %d And 12 = %H",a,12);
$writeh(" Using Formatted $writeh, a = %d",a, " And 12 = %H",12,"\\n");
$display("Print \\"%%\\",\\t\\"%%%%\\" should be used.");
$display("Use %%C or %%c: a's value %d %C",a,a);
$display("Use %%S or %%s: a's value %d %s",a,a);
$display("Use %%E or %%e: 10000.8 can be writen as %e ",10000.8);
$display("Use %%F or %%f: 1.023E+8 can be writen as %f ",1.023E+8);
$display("Use %%G or %%g: 1.023E+8 can be writen as %g ",1.023E+8);
$display("Use \\\\xyz : Character \\101's ASCII value is 3'O101");
$display("Use \\\\xyz : Character \\053's ASCII value is 3'O53");
#200 $finish;
end
endmodule
```

注意: 

1. 在verilog中, 转义符一定是使用在双引号括起来的字符串中！

2. "\\"和"%"后跟的不是前述指定的符号时, 行为跟仿真器的设计有关. 比如, "\\N"实现的不是换行功能, 但不同仿真器对其解释不同. 同样, 对于"\\%", "%\\"等1364-2001标准未规定的格式, 不同仿真器也可能进行不同的处理. 严格的说, 没有规定的转义表达式应该不能使用, 比如"\\%"这一形式. 一旦使用, 应该通不过编译, 并报告错误信息. 但是通过几个仿真器的仿真发现, 通常, "\\%"是允许的, 推广之, 发现"\\"后跟的如果不是表格中规定的转义符, "\\"将被忽略, 而直接输出之后的信息. 比如"\\%"就输出"%"符号, "\\N"就输出"N"符号. 但是"%\\"是不允许的, 推广之, 发现"%"后跟的如果不是表格中规定的转义符, 将报告错误. 

3. 除"%%"外, "%"引导的转义符的使用必须和对应的变量, 或者表达式匹配使用. 对应于某一个转义符的变量为空时, 可以用两个","将的空格来表示. 参见例2-2. 

4. "%C", "%S", "\\xyz"等形式的转义符都跟ASCII码有关. "\\xyz"输出值为八进制数"xyz"的ASCII码, 它不需要对应的变量（或者常量）列表. "%C", "%s"也是输出一个ASCII符号, 其值为变量列表中对应的变量, 常量或者表达式的值, 因此需要在变量列表中提供相应的变量, 常量或者表达式. 

##3. 使用方法##

在.v源文件中插入日志输出函数, 执行仿真, 结果将会在仿真器下方的**`console`**窗口中输出.
# Linux下利用core文件来调试segmentation fault问题

参考文章

[Linux下利用core来调试segmentation fault](http://blog.csdn.net/jubincn/article/details/7291472)

Segmentation fault(段错误)是由于虚拟内存管理单元的异常所致，而该异常则通常是由于解引用一个未初始化或非法值的指针引起的。

Linux中提供了`core dump`的功能，使得对这类错误的调试更为容易

## 1. 调试方法

### 1.1 允许生成Core文件

一般情况下，linux系统是不允许产生core文件的，因此首先要解除这个限制. Shell下执行：

```
ulimit -c unlimited    # 设置core大小为无限制
ulimit unlimited    # 设置文件大小为无限制(可以不执行这句, 防止core文件过大)
```

### 1.2 开始调试

执行有问题的程序, 当程序再次出现`Segmentation fault`时, 其所在目录下会出现一个core文件.

使用gdb对core文件进行调试的方法为`gdb [exec file] [core file]`;

进入gdb交互界面后, 输入`where/bt`命令, 可以定位到出问题的行及其所在函数

示例如下:

```
general@ubuntu:~/Code/Sync/sync/Snippet/C/huffman$ gdb ./huffmanMachine core 
...
...
Core was generated by `./huffmanMachine'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x0000000000401ca3 in Decode (HT=0x1017b10) at ./huffmanMachine.c:140
140	}
(gdb) where
#0  0x0000000000401ca3 in Decode (HT=0x1017b10) at ./huffmanMachine.c:140
#1  0x205349204d415247 in ?? ()
#2  0x524f56414620594d in ?? ()
#3  0x0000000000455449 in ?? ()
#4  0x0000000000000000 in ?? ()
(gdb) q
```

### 1.3

另外, 如果你的机器上跑很多的应用, 生成的core又不知道是哪个应用产生的, 你可以通过下列命令进行查看: file core. 如:

```
general@ubuntu:~/Code/Sync/sync/Snippet/C/huffman$ file core 
core: ELF 64-bit LSB  core file x86-64, version 1 (SYSV), SVR4-style, from './huffmanMachine'
```

## 2. 问题汇总

1. 声明了指针, 未分配空间就直接使用`memset`初始化一段内存, 当函数退出时会出现这个问题.
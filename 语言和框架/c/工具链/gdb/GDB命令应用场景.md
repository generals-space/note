# GDB 命令应用场景

## 1. 断点

`b 行号`    //在某行设置断点

`b 源文件名:行号` //多文件调试时在指定源文件的指定行设置断点

`info b`    //查看所有断点信息

`delete breakpoints`    断点号(一般是数字, 即断点的id, 自增的)  //删除一个断点

## 2. 复杂对象

`p *结构体对象`, 可以查看目标结构的成员内容, 这里的'结构体对象'指的是这个指针哦, 所以前面会有'*'号

p命令还可以直接查看某一地址中的内容，不过最好加上目标类型比如结构体类型，int等，不然看到的是这个地址上本身的内容。如

```
p *(struct request *) 0x8b274c0
```

`explore 结构体/对象` 可以查看目标结构体的成员变量, 或是目标对象的成员值

`explore type 结构体/对象`, 顾名思义, 可查看目标的类型及其成员类型

`explore value 对象`, 无法直接查看未实例化的结构体的内容, 只能查看其实例化之后的结构体对象的所有成员的值

## 3. 当前位置

`info source` 多文件调试时可以查看当前调试所在行的源文件文件名与其绝对路径

`info line` 可查看当前处于哪个源文件的第几行

`f/frame` 可查看当前处于哪个函数

## 4. 流程控制

`until 行号` 跳到指定行, 可用于跳出循环

`return` 可用于跳出当前函数(貌似finish不管用啊)

## 5. 变量设置

`set $自定义变量名=某值`, 可以设置用户自定义的变量;

`p $自定义变量名` 查看该变量的值

`set 源文件中变量名=某值`, 可以设置在调试过程中程序中的变量值, 注意, 一定要在该变量的作用域范围内才行, 不然找不到

`p 源文件中变量名`, 可用以查看变化

## 6. 宏

查看宏定义的值及其展开形式

普通编译时p命令是无法查询宏定义的, 需要修改gcc编译参数

在编译时将`-g`参数改为`-g3`, (代表编译等级, 具体可参考man手册), 然后使用`p 宏名称`就可以了.

`macro expand 宏名`    //查看宏的展开形式

## 7. 小技巧

有时循环次数太多, 但又不能直接跳过, 需要循环一定次数之后的结果时, 使用如下方式

set $counter = 0

b 行号 if ++$counter == 指定次数 //这里的行号应该是循环体内部某行的行号

然后run/r或continue/c即可.

根据这个方法, 假如我想得到执行到A行时, B行的执行次数, 也可以设置一个变量, 依然以$counter为例

set $counter = 0

b 源文件名:行号 if ++$counter == -1

即可, 不过这样使用r/c就没有意义了, 这个要求下一般还是要配合其他的断点设置然后单步调试的情形, 也就是A行设置了断点的情况下.
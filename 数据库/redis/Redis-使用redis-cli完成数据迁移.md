# Redis-使用redis-cli完成数据迁移

参考文章

1. [redis之间数据迁移](http://blog.chinaunix.net/uid-20776139-id-5679913.html)

## 1. 同一实例中不同库之间的数据迁移

我们知道, 使用`slaveof 源主机 源端口`+`slaveof no one`或者使用`save`命令得到dump文件进行数据迁移, 目标主机中的数据将是源主机redis的完全拷贝, 且目标主机原来的数据将被销毁.

当我们想要在同一实例的不同库之间进行迁移, 就不能用这些方法了. 可用的命令是`move`, 它的使用方法是:

```
redis-cli > move key1 2
```

将当前库中`key1`这个键, 移动到2库. 注意, 是移动不是复制, 原来的键会被移除.

另外, 当源库中不存在此键, 或者目标库本来存在同名键, 则移动会失败(相当于什么也没做).

`move`命令无法批量执行, 所以要依靠shell脚本. 如下示例中, 将1库中的所有数据移动到2库中.

```
$ redis-cli -n 1 keys '*' | xargs -i redis-cli -n 1 move {} 2
```

> 还有一个`smove`命令, 可以拷贝字典对象中的一个键, 记一下.

## 2. 不同实例/不同主机之间跨数据库迁移

